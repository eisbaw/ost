---
id: TASK-0001.07
title: 'TUI: Global search with Ctrl+K'
status: Done
assignee:
  - '@claude'
created_date: '2026-02-04 20:52'
updated_date: '2026-02-04 22:28'
labels:
  - tui
  - ratatui
dependencies:
  - TASK-0001.02
  - TASK-0001.03
references:
  - docs/specs/tui.txt
parent_task_id: TASK-0001
priority: medium
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
Implement global search functionality triggered by Ctrl+K. Shows search input at top, filters/searches across channels, chats, and messages as user types.
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria
<!-- AC:BEGIN -->
- [x] #1 Ctrl+K activates search bar at top of screen
- [x] #2 Search input with placeholder text
- [x] #3 Esc closes search and returns to previous state
- [x] #4 Enter on search result navigates to that item
- [x] #5 Search results update as user types
- [x] #6 xterm-tmux validation: Capture screenshot with search active showing results
<!-- AC:END -->

## Implementation Plan

<!-- SECTION:PLAN:BEGIN -->
1. Create src/tui/search.rs with SearchState, SearchResult, SearchResultKind, query editing, result filtering, and overlay rendering
2. Add mod search to src/tui/mod.rs
3. Add SearchState to App struct in app.rs, handle Ctrl+K activation, add handle_search_key and apply_search_selection methods
4. Update ui.rs to import search module and render overlay between main content and help popup
5. Add Ctrl+K hint to status bar
6. Build and validate with xterm-tmux
<!-- SECTION:PLAN:END -->

## Implementation Notes

<!-- SECTION:NOTES:BEGIN -->
- Created search.rs with SearchState (query, cursor_pos, results, selected, active), SearchResult with kind enum (Channel/Chat/Message)
- Search filters across sidebar teams/channels, chats, and messages (sender + content)
- Overlay renders at top of screen: search bar with cursor + results dropdown below
- Results show type icon (#/*/>) with label and context snippet
- Ctrl+K works from navigation mode and compose mode
- Esc closes search returning to previous state
- Enter on result navigates: channels/chats go to sidebar, messages go to messages pane
- Selecting a channel in a collapsed team auto-expands the team
- No results case shows "No results found" message
- Status bar shows "C-k: search" hint
- All validated via xterm-tmux testing
<!-- SECTION:NOTES:END -->

## Final Summary

<!-- SECTION:FINAL_SUMMARY:BEGIN -->
Implemented global search overlay for the TUI, activated by Ctrl+K.\n\nChanges:\n- New src/tui/search.rs: SearchState with query editing, case-insensitive filtering across teams/channels/chats/messages, overlay rendering with type icons and result navigation\n- Ctrl+K works from any mode, Esc closes, Enter navigates to result\n- Channel selection auto-expands collapsed teams\n- UTF-8 safe string truncation, derive(Default) per clippy"
<!-- SECTION:FINAL_SUMMARY:END -->
