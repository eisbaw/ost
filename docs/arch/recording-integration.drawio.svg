<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1533px" height="1102px" viewBox="-0.5 -0.5 1533 1102" content="&lt;mxfile host=&quot;Electron&quot; agent=&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.7.17 Chrome/130.0.6723.191 Electron/33.3.2 Safari/537.36&quot; version=&quot;24.7.17&quot;&gt;&#10;  &lt;diagram id=&quot;recording-integration-arch&quot; name=&quot;Recording Integration Architecture&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;-839&quot; dy=&quot;-307&quot; grid=&quot;0&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;0&quot; page=&quot;0&quot; pageScale=&quot;1&quot; pageWidth=&quot;1800&quot; pageHeight=&quot;1400&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;title&quot; value=&quot;Microsoft Teams Recording Integration Architecture&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;450&quot; y=&quot;20&quot; width=&quot;600&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;bot-title&quot; value=&quot;Recorder Bot Service Principal&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;50&quot; y=&quot;80&quot; width=&quot;300&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;bot-container&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;dashed=1;strokeWidth=2&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;50&quot; y=&quot;120&quot; width=&quot;400&quot; height=&quot;260&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;app-reg&quot; value=&quot;&amp;lt;b&amp;gt;Azure AD App Registration&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left&amp;quot;&amp;gt;- Application (client) ID&amp;lt;br&amp;gt;- Directory (tenant) ID&amp;lt;br&amp;gt;- Client secret / certificate&amp;lt;br&amp;gt;- Bot Framework registration&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;70&quot; y=&quot;140&quot; width=&quot;170&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;service-principal&quot; value=&quot;&amp;lt;b&amp;gt;Service Principal&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left&amp;quot;&amp;gt;- Object ID (GUID)&amp;lt;br&amp;gt;- MRI: 28:{app-id}&amp;lt;br&amp;gt;- Graph API permissions&amp;lt;br&amp;gt;- Communications.AccessMedia&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;260&quot; y=&quot;140&quot; width=&quot;170&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;permissions&quot; value=&quot;&amp;lt;b&amp;gt;Required Permissions&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left;font-size:10px&amp;quot;&amp;gt;- Calls.JoinGroupCall.All&amp;lt;br&amp;gt;- Calls.AccessMedia.All&amp;lt;br&amp;gt;- OnlineMeetings.Read.All&amp;lt;br&amp;gt;- Application consent required&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;70&quot; y=&quot;265&quot; width=&quot;360&quot; height=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;app-to-sp&quot; value=&quot;creates&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;app-reg&quot; target=&quot;service-principal&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;token-title&quot; value=&quot;Recorder Token Acquisition Flow&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;500&quot; y=&quot;80&quot; width=&quot;300&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;token-container&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;dashed=1;strokeWidth=2&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;500&quot; y=&quot;120&quot; width=&quot;550&quot; height=&quot;260&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;recorder-bot&quot; value=&quot;&amp;lt;b&amp;gt;Recorder&amp;lt;br&amp;gt;Bot&amp;lt;/b&amp;gt;&quot; style=&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;520&quot; y=&quot;170&quot; width=&quot;80&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;azure-ad&quot; value=&quot;&amp;lt;b&amp;gt;Azure AD&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;(Identity Provider)&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;680&quot; y=&quot;160&quot; width=&quot;100&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;graph-api&quot; value=&quot;&amp;lt;b&amp;gt;Microsoft&amp;lt;br&amp;gt;Graph API&amp;lt;/b&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;860&quot; y=&quot;160&quot; width=&quot;100&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;token-step1&quot; value=&quot;1. Client credentials&amp;lt;br&amp;gt;grant (app-only)&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;recorder-bot&quot; target=&quot;azure-ad&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;token-step2&quot; value=&quot;2. Access token&amp;lt;br&amp;gt;(Graph scope)&quot; style=&quot;html=1;verticalAlign=top;endArrow=block;rounded=0;strokeWidth=2;fontSize=10;dashed=1&quot; parent=&quot;1&quot; source=&quot;azure-ad&quot; target=&quot;recorder-bot&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;640&quot; y=&quot;250&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;token-step3&quot; value=&quot;3. Call API with&amp;lt;br&amp;gt;bearer token&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;azure-ad&quot; target=&quot;graph-api&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;token-details&quot; value=&quot;&amp;lt;b&amp;gt;Token Details&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left;font-size:10px&amp;quot;&amp;gt;- Scope: https://graph.microsoft.com/.default&amp;lt;br&amp;gt;- Grant type: client_credentials&amp;lt;br&amp;gt;- Token lifetime: ~60 minutes&amp;lt;br&amp;gt;- Requires refresh before expiry&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;520&quot; y=&quot;280&quot; width=&quot;230&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;media-token&quot; value=&quot;&amp;lt;b&amp;gt;Media Access Token&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left;font-size:10px&amp;quot;&amp;gt;- Separate from Graph token&amp;lt;br&amp;gt;- Obtained via /calls/{id}/subscribeToTone&amp;lt;br&amp;gt;- Required for SRTP media access&amp;lt;br&amp;gt;- Short-lived, per-call basis&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;770&quot; y=&quot;280&quot; width=&quot;260&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;lifecycle-title&quot; value=&quot;Recording Lifecycle State Machine&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;50&quot; y=&quot;410&quot; width=&quot;300&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;lifecycle-container&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;strokeWidth=2&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;50&quot; y=&quot;450&quot; width=&quot;700&quot; height=&quot;200&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-idle&quot; value=&quot;IDLE&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;fontStyle=1;fontSize=14&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;80&quot; y=&quot;510&quot; width=&quot;90&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-initial&quot; value=&quot;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;110&quot; y=&quot;465&quot; width=&quot;30&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-initial-arrow&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;strokeWidth=2&quot; parent=&quot;1&quot; source=&quot;rec-initial&quot; target=&quot;rec-idle&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-starting&quot; value=&quot;STARTING&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontStyle=1;fontSize=14&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;220&quot; y=&quot;510&quot; width=&quot;90&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-recording&quot; value=&quot;RECORDING&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontStyle=1;fontSize=14&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;370&quot; y=&quot;510&quot; width=&quot;100&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-paused&quot; value=&quot;PAUSED&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;fontStyle=1;fontSize=14&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;370&quot; y=&quot;590&quot; width=&quot;100&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-stopping&quot; value=&quot;STOPPING&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;fontStyle=1;fontSize=14&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;530&quot; y=&quot;510&quot; width=&quot;90&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-stopped&quot; value=&quot;STOPPED&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;fontStyle=1;fontSize=14&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;650&quot; y=&quot;510&quot; width=&quot;90&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-final&quot; value=&quot;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#000000;strokeColor=#000000;strokeWidth=3&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;680&quot; y=&quot;590&quot; width=&quot;30&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;rec-final-inner&quot; value=&quot;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#000000&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;685&quot; y=&quot;595&quot; width=&quot;20&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;t-idle-starting&quot; value=&quot;startRecording&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;rec-idle&quot; target=&quot;rec-starting&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;t-starting-recording&quot; value=&quot;mediaReady&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;rec-starting&quot; target=&quot;rec-recording&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;t-recording-paused&quot; value=&quot;pause&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;rec-recording&quot; target=&quot;rec-paused&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;t-paused-recording&quot; value=&quot;resume&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10;exitX=0.5;exitY=0;entryX=0.5;entryY=1;curved=1&quot; parent=&quot;1&quot; source=&quot;rec-paused&quot; target=&quot;rec-recording&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;320&quot; y=&quot;580&quot; /&gt;&#10;              &lt;mxPoint x=&quot;320&quot; y=&quot;570&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;t-recording-stopping&quot; value=&quot;stopRecording&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;rec-recording&quot; target=&quot;rec-stopping&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;t-stopping-stopped&quot; value=&quot;finalized&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;rec-stopping&quot; target=&quot;rec-stopped&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;t-stopped-final&quot; value=&quot;cleanup&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; source=&quot;rec-stopped&quot; target=&quot;rec-final&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;t-paused-stopping&quot; value=&quot;stop&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10;exitX=1;exitY=0.5;entryX=0.5;entryY=1&quot; parent=&quot;1&quot; source=&quot;rec-paused&quot; target=&quot;rec-stopping&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;575&quot; y=&quot;615&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inject-title&quot; value=&quot;Bot Injection into Active Call&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;50&quot; y=&quot;680&quot; width=&quot;300&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inject-container&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;strokeWidth=2&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;50&quot; y=&quot;720&quot; width=&quot;1100&quot; height=&quot;400&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-bot&quot; value=&quot;&amp;lt;b&amp;gt;Recorder&amp;lt;br&amp;gt;Bot&amp;lt;/b&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=0&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;100&quot; y=&quot;740&quot; width=&quot;80&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-bot-line&quot; value=&quot;&quot; style=&quot;endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#b85450&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;140&quot; y=&quot;790&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;140&quot; y=&quot;1100&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-graph&quot; value=&quot;&amp;lt;b&amp;gt;Microsoft&amp;lt;br&amp;gt;Graph API&amp;lt;/b&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=0&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;300&quot; y=&quot;740&quot; width=&quot;80&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-graph-line&quot; value=&quot;&quot; style=&quot;endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#d79b00&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;340&quot; y=&quot;790&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;340&quot; y=&quot;1100&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-signal&quot; value=&quot;&amp;lt;b&amp;gt;Call&amp;lt;br&amp;gt;Signaling&amp;lt;/b&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=0&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;500&quot; y=&quot;740&quot; width=&quot;80&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-signal-line&quot; value=&quot;&quot; style=&quot;endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#6c8ebf&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;540&quot; y=&quot;790&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;540&quot; y=&quot;1100&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-call&quot; value=&quot;&amp;lt;b&amp;gt;Active&amp;lt;br&amp;gt;Call&amp;lt;/b&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=0&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;700&quot; y=&quot;740&quot; width=&quot;80&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-call-line&quot; value=&quot;&quot; style=&quot;endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#82b366&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;740&quot; y=&quot;790&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;740&quot; y=&quot;1100&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-media-svc&quot; value=&quot;&amp;lt;b&amp;gt;Media&amp;lt;br&amp;gt;Service&amp;lt;/b&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=0&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;900&quot; y=&quot;740&quot; width=&quot;80&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll-media-line&quot; value=&quot;&quot; style=&quot;endArrow=none;dashed=1;html=1;strokeWidth=2;strokeColor=#9673a6&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;940&quot; y=&quot;790&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;940&quot; y=&quot;1100&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inj-msg1&quot; value=&quot;1. POST /communications/calls (joinMeetingId)&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;140&quot; y=&quot;820&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;340&quot; y=&quot;820&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inj-msg2&quot; value=&quot;2. Validate permissions &amp;amp; tenant policy&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;340&quot; y=&quot;855&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;540&quot; y=&quot;855&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inj-msg3&quot; value=&quot;3. Add bot as hidden participant&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;540&quot; y=&quot;890&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;740&quot; y=&quot;890&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;state-joining&quot; value=&quot;[STARTING]&quot; style=&quot;text;html=1;strokeColor=none;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;110&quot; y=&quot;900&quot; width=&quot;60&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inj-msg4&quot; value=&quot;4. SDP offer (receiveOnly for media capture)&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;740&quot; y=&quot;925&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;940&quot; y=&quot;925&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inj-msg5&quot; value=&quot;5. SDP answer (media endpoints)&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10;dashed=1&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;940&quot; y=&quot;955&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;740&quot; y=&quot;955&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inj-msg6&quot; value=&quot;6. recordingStateChanged (started)&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10;dashed=1&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;540&quot; y=&quot;990&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;140&quot; y=&quot;990&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;state-rec-active&quot; value=&quot;[RECORDING]&quot; style=&quot;text;html=1;strokeColor=none;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;105&quot; y=&quot;1000&quot; width=&quot;70&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;media-capture&quot; value=&quot;Audio/Video RTP streams (receive-only)&quot; style=&quot;html=1;verticalAlign=middle;endArrow=classic;rounded=0;strokeWidth=2;strokeColor=#9673a6;dashed=1&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;940&quot; y=&quot;1030&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;140&quot; y=&quot;1030&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;inj-msg7&quot; value=&quot;7. DELETE /communications/calls/{id} or callEnded&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;rounded=0;strokeWidth=2;fontSize=10&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;140&quot; y=&quot;1065&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;340&quot; y=&quot;1065&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;state-rec-stopped&quot; value=&quot;[STOPPED]&quot; style=&quot;text;html=1;strokeColor=none;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;110&quot; y=&quot;1075&quot; width=&quot;60&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ep-title&quot; value=&quot;Recording Service Endpoints&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1100&quot; y=&quot;80&quot; width=&quot;300&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;graph-calls&quot; value=&quot;&amp;lt;b&amp;gt;Graph Communications API&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left;font-family:monospace;font-size:10px&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Join Call:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;POST /communications/calls&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Get Call:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;GET /communications/calls/{id}&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Leave Call:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;DELETE /communications/calls/{id}&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Update Recording:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;POST /calls/{id}/updateRecordingStatus&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Subscribe to Media:&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;POST /calls/{id}/subscribeToTone&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;align=center;verticalAlign=top;spacing=8&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1100&quot; y=&quot;120&quot; width=&quot;260&quot; height=&quot;260&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;join-body&quot; value=&quot;&amp;lt;b&amp;gt;Join Call Payload&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left;font-family:monospace;font-size:9px&amp;quot;&amp;gt;{&amp;lt;br&amp;gt;  &amp;quot;@odata.type&amp;quot;: &amp;quot;#microsoft&amp;lt;br&amp;gt;    .graph.call&amp;quot;,&amp;lt;br&amp;gt;  &amp;quot;callbackUri&amp;quot;: &amp;quot;https://...&amp;quot;,&amp;lt;br&amp;gt;  &amp;quot;requestedModalities&amp;quot;: [&amp;lt;br&amp;gt;    &amp;quot;audio&amp;quot;, &amp;quot;video&amp;quot;&amp;lt;br&amp;gt;  ],&amp;lt;br&amp;gt;  &amp;quot;mediaConfig&amp;quot;: {&amp;lt;br&amp;gt;    &amp;quot;@odata.type&amp;quot;: &amp;quot;#microsoft&amp;lt;br&amp;gt;      .graph.appHostedMediaConfig&amp;quot;,&amp;lt;br&amp;gt;    &amp;quot;blob&amp;quot;: &amp;quot;{sdp-blob}&amp;quot;&amp;lt;br&amp;gt;  },&amp;lt;br&amp;gt;  &amp;quot;chatInfo&amp;quot;: {&amp;lt;br&amp;gt;    &amp;quot;threadId&amp;quot;: &amp;quot;19:meeting...&amp;quot;,&amp;lt;br&amp;gt;    &amp;quot;messageId&amp;quot;: &amp;quot;0&amp;quot;&amp;lt;br&amp;gt;  },&amp;lt;br&amp;gt;  &amp;quot;meetingInfo&amp;quot;: {&amp;lt;br&amp;gt;    &amp;quot;@odata.type&amp;quot;: &amp;quot;#microsoft&amp;lt;br&amp;gt;      .graph.organizerMeetingInfo&amp;quot;,&amp;lt;br&amp;gt;    &amp;quot;organizer&amp;quot;: {&amp;lt;br&amp;gt;      &amp;quot;identity&amp;quot;: { ... }&amp;lt;br&amp;gt;    }&amp;lt;br&amp;gt;  }&amp;lt;br&amp;gt;}&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1380&quot; y=&quot;120&quot; width=&quot;200&quot; height=&quot;380&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;status-updates&quot; value=&quot;&amp;lt;b&amp;gt;Recording Status Values&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left;font-size:11px&amp;quot;&amp;gt;&amp;lt;b&amp;gt;notRecording&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;No active recording&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;recording&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Active recording in progress&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;failed&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Recording failed to start&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1100&quot; y=&quot;400&quot; width=&quot;200&quot; height=&quot;150&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;callbacks&quot; value=&quot;&amp;lt;b&amp;gt;Callback Notifications&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left;font-size:11px&amp;quot;&amp;gt;&amp;lt;b&amp;gt;callStateChanged&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Bot joined/left call&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;participantsUpdated&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Roster changes&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;recordingStateChanged&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Recording status update&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;mediaStateChanged&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Media channel state&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1100&quot; y=&quot;570&quot; width=&quot;200&quot; height=&quot;180&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;media-config&quot; value=&quot;&amp;lt;b&amp;gt;Media Configuration&amp;lt;/b&amp;gt;&amp;lt;hr&amp;gt;&amp;lt;div style=&amp;quot;text-align:left;font-size:10px&amp;quot;&amp;gt;- appHostedMediaConfig: Bot hosts media&amp;lt;br&amp;gt;- serviceHostedMediaConfig: Teams hosts&amp;lt;br&amp;gt;- Recording bots use app-hosted&amp;lt;br&amp;gt;- Requires media platform SDK&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=center;verticalAlign=top;spacing=5&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1380&quot; y=&quot;520&quot; width=&quot;200&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;relation-title&quot; value=&quot;Relationship to Call Signaling&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1200&quot; y=&quot;680&quot; width=&quot;250&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;relation-box&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align:left;font-size:11px&amp;quot;&amp;gt;The recorder bot participates in the same call signaling&amp;lt;br&amp;gt;infrastructure as regular clients:&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;1. &amp;lt;b&amp;gt;Joins via Graph API&amp;lt;/b&amp;gt; (not Trouter invitation)&amp;lt;br&amp;gt;2. &amp;lt;b&amp;gt;Receives SDP offer/answer&amp;lt;/b&amp;gt; like any participant&amp;lt;br&amp;gt;3. &amp;lt;b&amp;gt;Gets roster updates&amp;lt;/b&amp;gt; via callback notifications&amp;lt;br&amp;gt;4. &amp;lt;b&amp;gt;Media flows through SRTP&amp;lt;/b&amp;gt; to bot endpoint&amp;lt;br&amp;gt;5. &amp;lt;b&amp;gt;Leaves call&amp;lt;/b&amp;gt; via DELETE or when call ends&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Key difference: Bot uses &amp;lt;b&amp;gt;receiveOnly&amp;lt;/b&amp;gt; media direction&amp;lt;br&amp;gt;to capture without transmitting.&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;verticalAlign=top;spacing=10&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;1200&quot; y=&quot;720&quot; width=&quot;380&quot; height=&quot;180&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-title&quot; value=&quot;Legend&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;800&quot; y=&quot;410&quot; width=&quot;100&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-box&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;dashed=0&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;800&quot; y=&quot;450&quot; width=&quot;200&quot; height=&quot;150&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-http&quot; value=&quot;&quot; style=&quot;endArrow=block;html=1;strokeWidth=2&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;815&quot; y=&quot;475&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;865&quot; y=&quot;475&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-http-text&quot; value=&quot;HTTP Request&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;875&quot; y=&quot;465&quot; width=&quot;100&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-ws&quot; value=&quot;&quot; style=&quot;endArrow=block;html=1;strokeWidth=2;dashed=1&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;815&quot; y=&quot;505&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;865&quot; y=&quot;505&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-ws-text&quot; value=&quot;Callback / Notification&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;875&quot; y=&quot;495&quot; width=&quot;120&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-media&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;strokeWidth=2;strokeColor=#9673a6;dashed=1&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;815&quot; y=&quot;535&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;865&quot; y=&quot;535&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-media-text&quot; value=&quot;Media Stream&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;875&quot; y=&quot;525&quot; width=&quot;100&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-state&quot; value=&quot;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;815&quot; y=&quot;555&quot; width=&quot;50&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend-state-text&quot; value=&quot;State&quot; style=&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=10&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;875&quot; y=&quot;560&quot; width=&quot;50&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="title"><g><rect x="401" y="0" width="600" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 598px; height: 1px; padding-top: 20px; margin-left: 402px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 24px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">Microsoft Teams Recording Integration Architecture</div></div></div></foreignObject><text x="701" y="27" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="24px" text-anchor="middle" font-weight="bold">Microsoft Teams Recording Integration Architecture</text></switch></g></g></g><g data-cell-id="bot-title"><g><rect x="1" y="60" width="300" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 298px; height: 1px; padding-top: 75px; margin-left: 3px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">Recorder Bot Service Principal</div></div></div></foreignObject><text x="3" y="80" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="16px" font-weight="bold">Recorder Bot Service Principal</text></switch></g></g></g><g data-cell-id="bot-container"><g><rect x="1" y="100" width="400" height="260" rx="39" ry="39" fill="#e1d5e7" stroke="#9673a6" stroke-width="2" stroke-dasharray="6 6" pointer-events="all"/></g></g><g data-cell-id="app-reg"><g><rect x="21" y="120" width="170" height="110" rx="16.5" ry="16.5" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 162px; height: 1px; padding-top: 130px; margin-left: 25px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Azure AD App Registration</b><hr /><div style="text-align:left">- Application (client) ID<br />- Directory (tenant) ID<br />- Client secret / certificate<br />- Bot Framework registration</div></div></div></div></foreignObject><text x="106" y="142" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Azure AD App Registration...</text></switch></g></g></g><g data-cell-id="service-principal"><g><rect x="211" y="120" width="170" height="110" rx="16.5" ry="16.5" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 162px; height: 1px; padding-top: 130px; margin-left: 215px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Service Principal</b><hr /><div style="text-align:left">- Object ID (GUID)<br />- MRI: 28:{app-id}<br />- Graph API permissions<br />- Communications.AccessMedia</div></div></div></div></foreignObject><text x="296" y="142" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Service Principal...</text></switch></g></g></g><g data-cell-id="permissions"><g><rect x="21" y="245" width="360" height="100" rx="15" ry="15" fill="#f5f5f5" stroke="#666666" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 352px; height: 1px; padding-top: 255px; margin-left: 25px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Required Permissions</b><hr /><div style="text-align:left;font-size:10px">- Calls.JoinGroupCall.All<br />- Calls.AccessMedia.All<br />- OnlineMeetings.Read.All<br />- Application consent required</div></div></div></div></foreignObject><text x="201" y="267" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Required Permissions...</text></switch></g></g></g><g data-cell-id="app-to-sp"><g><path d="M 191 175 L 211 175 L 191 175 L 202.76 175" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 208.76 175 L 200.76 179 L 202.76 175 L 200.76 171 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 175px; margin-left: 201px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">creates</div></div></div></foreignObject><text x="201" y="178" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">creates</text></switch></g></g></g><g data-cell-id="token-title"><g><rect x="451" y="60" width="300" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 298px; height: 1px; padding-top: 75px; margin-left: 453px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">Recorder Token Acquisition Flow</div></div></div></foreignObject><text x="453" y="80" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="16px" font-weight="bold">Recorder Token Acquisition Flow</text></switch></g></g></g><g data-cell-id="token-container"><g><rect x="451" y="100" width="550" height="260" rx="39" ry="39" fill="#d5e8d4" stroke="#82b366" stroke-width="2" stroke-dasharray="6 6" pointer-events="all"/></g></g><g data-cell-id="recorder-bot"><g><path d="M 491 150 L 531 150 L 551 180 L 531 210 L 491 210 L 471 180 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 180px; margin-left: 472px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Recorder<br />Bot</b></div></div></div></foreignObject><text x="511" y="184" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Recorder...</text></switch></g></g></g><g data-cell-id="azure-ad"><g><rect x="631" y="140" width="100" height="60" rx="9" ry="9" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 170px; margin-left: 632px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Azure AD</b><br />(Identity Provider)</div></div></div></foreignObject><text x="681" y="174" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Azure AD...</text></switch></g></g></g><g data-cell-id="graph-api"><g><rect x="811" y="140" width="100" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 170px; margin-left: 812px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Microsoft<br />Graph API</b></div></div></div></foreignObject><text x="861" y="174" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Microsoft...</text></switch></g></g></g><g data-cell-id="token-step1"><g><path d="M 549.49 177.74 L 620.78 173.54" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 628.77 173.07 L 621.02 177.54 L 620.55 169.55 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 172px; margin-left: 590px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">1. Client credentials<br />grant (app-only)</div></div></div></foreignObject><text x="590" y="172" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">1. Client credentials...</text></switch></g></g></g><g data-cell-id="token-step2"><g><path d="M 636 200 L 591 230 L 547.92 203.07" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 541.13 198.83 L 550.04 199.68 L 545.8 206.46 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 235px; margin-left: 588px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">2. Access token<br />(Graph scope)</div></div></div></foreignObject><text x="588" y="245" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">2. Access token...</text></switch></g></g></g><g data-cell-id="token-step3"><g><path d="M 731 170 L 800.76 170" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 808.76 170 L 800.76 174 L 800.76 166 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 167px; margin-left: 771px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">3. Call API with<br />bearer token</div></div></div></foreignObject><text x="771" y="167" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">3. Call API with...</text></switch></g></g></g><g data-cell-id="token-details"><g><rect x="471" y="260" width="230" height="90" rx="13.5" ry="13.5" fill="#f5f5f5" stroke="#666666" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 222px; height: 1px; padding-top: 270px; margin-left: 475px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Token Details</b><hr /><div style="text-align:left;font-size:10px">- Scope: https://graph.microsoft.com/.default<br />- Grant type: client_credentials<br />- Token lifetime: ~60 minutes<br />- Requires refresh before expiry</div></div></div></div></foreignObject><text x="586" y="282" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Token Details...</text></switch></g></g></g><g data-cell-id="media-token"><g><rect x="721" y="260" width="260" height="90" rx="13.5" ry="13.5" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 252px; height: 1px; padding-top: 270px; margin-left: 725px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Media Access Token</b><hr /><div style="text-align:left;font-size:10px">- Separate from Graph token<br />- Obtained via /calls/{id}/subscribeToTone<br />- Required for SRTP media access<br />- Short-lived, per-call basis</div></div></div></div></foreignObject><text x="851" y="282" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Media Access Token...</text></switch></g></g></g><g data-cell-id="lifecycle-title"><g><rect x="1" y="390" width="300" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 298px; height: 1px; padding-top: 405px; margin-left: 3px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">Recording Lifecycle State Machine</div></div></div></foreignObject><text x="3" y="410" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="16px" font-weight="bold">Recording Lifecycle State Machine</text></switch></g></g></g><g data-cell-id="lifecycle-container"><g><rect x="1" y="430" width="700" height="200" rx="30" ry="30" fill="#f5f5f5" stroke="#666666" stroke-width="2" stroke-dasharray="6 6" pointer-events="all"/></g></g><g data-cell-id="rec-idle"><g><ellipse cx="76" cy="515" rx="45" ry="25" fill="#d5e8d4" stroke="#82b366" stroke-width="2" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 515px; margin-left: 32px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">IDLE</div></div></div></foreignObject><text x="76" y="519" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="14px" text-anchor="middle" font-weight="bold">IDLE</text></switch></g></g></g><g data-cell-id="rec-initial"><g><ellipse cx="76" cy="460" rx="15" ry="15" fill="#000000" stroke="#000000" pointer-events="all"/></g></g><g data-cell-id="rec-initial-arrow"><g><path d="M 76 475 L 76 481.76" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 76 487.76 L 72 479.76 L 76 481.76 L 80 479.76 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="rec-starting"><g><ellipse cx="216" cy="515" rx="45" ry="25" fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 515px; margin-left: 172px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">STARTING</div></div></div></foreignObject><text x="216" y="519" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="14px" text-anchor="middle" font-weight="bold">STARTING</text></switch></g></g></g><g data-cell-id="rec-recording"><g><ellipse cx="371" cy="515" rx="50" ry="25" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 515px; margin-left: 322px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">RECORDING</div></div></div></foreignObject><text x="371" y="519" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="14px" text-anchor="middle" font-weight="bold">RECORDING</text></switch></g></g></g><g data-cell-id="rec-paused"><g><ellipse cx="371" cy="595" rx="50" ry="25" fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 595px; margin-left: 322px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">PAUSED</div></div></div></foreignObject><text x="371" y="599" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="14px" text-anchor="middle" font-weight="bold">PAUSED</text></switch></g></g></g><g data-cell-id="rec-stopping"><g><ellipse cx="526" cy="515" rx="45" ry="25" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 515px; margin-left: 482px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">STOPPING</div></div></div></foreignObject><text x="526" y="519" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="14px" text-anchor="middle" font-weight="bold">STOPPING</text></switch></g></g></g><g data-cell-id="rec-stopped"><g><ellipse cx="646" cy="515" rx="45" ry="25" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 515px; margin-left: 602px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">STOPPED</div></div></div></foreignObject><text x="646" y="519" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="14px" text-anchor="middle" font-weight="bold">STOPPED</text></switch></g></g></g><g data-cell-id="rec-final"><g><ellipse cx="646" cy="585" rx="15" ry="15" fill="#000000" stroke="#000000" stroke-width="3" pointer-events="all"/></g></g><g data-cell-id="rec-final-inner"><g><ellipse cx="646" cy="585" rx="10" ry="10" fill="#ffffff" stroke="#000000" pointer-events="all"/></g></g><g data-cell-id="t-idle-starting"><g><path d="M 121 515 L 162.76 515" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 168.76 515 L 160.76 519 L 162.76 515 L 160.76 511 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 515px; margin-left: 146px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">startRecording</div></div></div></foreignObject><text x="146" y="518" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">startRecording</text></switch></g></g></g><g data-cell-id="t-starting-recording"><g><path d="M 261 515 L 312.76 515" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 318.76 515 L 310.76 519 L 312.76 515 L 310.76 511 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 515px; margin-left: 291px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">mediaReady</div></div></div></foreignObject><text x="291" y="518" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">mediaReady</text></switch></g></g></g><g data-cell-id="t-recording-paused"><g><path d="M 371 540 L 371 560 L 371 550 L 371 561.76" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 371 567.76 L 367 559.76 L 371 561.76 L 375 559.76 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 555px; margin-left: 371px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">pause</div></div></div></foreignObject><text x="371" y="558" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">pause</text></switch></g></g></g><g data-cell-id="t-paused-recording"><g><path d="M 371 570 Q 371 560 321 560 Q 271 560 271 555 Q 271 550 321 550 Q 371 550 371 548.24" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 371 542.24 L 375 550.24 L 371 548.24 L 367 550.24 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 555px; margin-left: 271px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">resume</div></div></div></foreignObject><text x="271" y="558" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">resume</text></switch></g></g></g><g data-cell-id="t-recording-stopping"><g><path d="M 421 515 L 472.76 515" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 478.76 515 L 470.76 519 L 472.76 515 L 470.76 511 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 515px; margin-left: 451px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">stopRecording</div></div></div></foreignObject><text x="451" y="518" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">stopRecording</text></switch></g></g></g><g data-cell-id="t-stopping-stopped"><g><path d="M 571 515 L 591 515 L 581 515 L 592.76 515" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 598.76 515 L 590.76 519 L 592.76 515 L 590.76 511 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 515px; margin-left: 586px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">finalized</div></div></div></foreignObject><text x="586" y="518" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">finalized</text></switch></g></g></g><g data-cell-id="t-stopped-final"><g><path d="M 646 540 L 646 560 L 646 550 L 646 561.76" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 646 567.76 L 642 559.76 L 646 561.76 L 650 559.76 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 555px; margin-left: 646px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">cleanup</div></div></div></foreignObject><text x="646" y="558" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">cleanup</text></switch></g></g></g><g data-cell-id="t-paused-stopping"><g><path d="M 421 595 L 526 595 L 526 548.24" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 526 542.24 L 530 550.24 L 526 548.24 L 522 550.24 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 595px; margin-left: 501px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">stop</div></div></div></foreignObject><text x="501" y="598" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">stop</text></switch></g></g></g><g data-cell-id="inject-title"><g><rect x="1" y="660" width="300" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 298px; height: 1px; padding-top: 675px; margin-left: 3px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">Bot Injection into Active Call</div></div></div></foreignObject><text x="3" y="680" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="16px" font-weight="bold">Bot Injection into Active Call</text></switch></g></g></g><g data-cell-id="inject-container"><g><rect x="1" y="700" width="1100" height="400" rx="60" ry="60" fill="#f5f5f5" stroke="#666666" stroke-width="2" stroke-dasharray="6 6" pointer-events="all"/></g></g><g data-cell-id="ll-bot"><g><rect x="51" y="720" width="80" height="50" rx="7.5" ry="7.5" fill="#f8cecc" stroke="#b85450" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 745px; margin-left: 52px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Recorder<br />Bot</b></div></div></div></foreignObject><text x="91" y="749" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Recorder...</text></switch></g></g></g><g data-cell-id="ll-bot-line"><g><path d="M 91 770 L 91 1080" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/></g></g><g data-cell-id="ll-graph"><g><rect x="251" y="720" width="80" height="50" rx="7.5" ry="7.5" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 745px; margin-left: 252px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Microsoft<br />Graph API</b></div></div></div></foreignObject><text x="291" y="749" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Microsoft...</text></switch></g></g></g><g data-cell-id="ll-graph-line"><g><path d="M 291 770 L 291 1080" fill="none" stroke="#d79b00" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/></g></g><g data-cell-id="ll-signal"><g><rect x="451" y="720" width="80" height="50" rx="7.5" ry="7.5" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 745px; margin-left: 452px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Call<br />Signaling</b></div></div></div></foreignObject><text x="491" y="749" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Call...</text></switch></g></g></g><g data-cell-id="ll-signal-line"><g><path d="M 491 770 L 491 1080" fill="none" stroke="#6c8ebf" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/></g></g><g data-cell-id="ll-call"><g><rect x="651" y="720" width="80" height="50" rx="7.5" ry="7.5" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 745px; margin-left: 652px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Active<br />Call</b></div></div></div></foreignObject><text x="691" y="749" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Active...</text></switch></g></g></g><g data-cell-id="ll-call-line"><g><path d="M 691 770 L 691 1080" fill="none" stroke="#82b366" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/></g></g><g data-cell-id="ll-media-svc"><g><rect x="851" y="720" width="80" height="50" rx="7.5" ry="7.5" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 745px; margin-left: 852px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Media<br />Service</b></div></div></div></foreignObject><text x="891" y="749" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Media...</text></switch></g></g></g><g data-cell-id="ll-media-line"><g><path d="M 891 770 L 891 1080" fill="none" stroke="#9673a6" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/></g></g><g data-cell-id="inj-msg1"><g><path d="M 91 800 L 280.76 800" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 288.76 800 L 280.76 804 L 280.76 796 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 797px; margin-left: 191px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">1. POST /communications/calls (joinMeetingId)</div></div></div></foreignObject><text x="191" y="797" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">1. POST /communications/calls (joinMeetingId)</text></switch></g></g></g><g data-cell-id="inj-msg2"><g><path d="M 291 835 L 480.76 835" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 488.76 835 L 480.76 839 L 480.76 831 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 832px; margin-left: 391px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">2. Validate permissions &amp; tenant policy</div></div></div></foreignObject><text x="391" y="832" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">2. Validate permissions &amp; tenant policy</text></switch></g></g></g><g data-cell-id="inj-msg3"><g><path d="M 491 870 L 680.76 870" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 688.76 870 L 680.76 874 L 680.76 866 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 867px; margin-left: 591px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">3. Add bot as hidden participant</div></div></div></foreignObject><text x="591" y="867" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">3. Add bot as hidden participant</text></switch></g></g></g><g data-cell-id="state-joining"><g><rect x="61" y="880" width="60" height="20" rx="3" ry="3" fill="#fff2cc" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 890px; margin-left: 62px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">[STARTING]</div></div></div></foreignObject><text x="91" y="893" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle" font-weight="bold">[STARTING]</text></switch></g></g></g><g data-cell-id="inj-msg4"><g><path d="M 691 905 L 880.76 905" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 888.76 905 L 880.76 909 L 880.76 901 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 902px; margin-left: 791px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">4. SDP offer (receiveOnly for media capture)</div></div></div></foreignObject><text x="791" y="902" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">4. SDP offer (receiveOnly for media capture)</text></switch></g></g></g><g data-cell-id="inj-msg5"><g><path d="M 891 935 L 701.24 935" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 693.24 935 L 701.24 931 L 701.24 939 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 932px; margin-left: 791px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">5. SDP answer (media endpoints)</div></div></div></foreignObject><text x="791" y="932" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">5. SDP answer (media endpoints)</text></switch></g></g></g><g data-cell-id="inj-msg6"><g><path d="M 491 970 L 101.24 970" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 93.24 970 L 101.24 966 L 101.24 974 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 967px; margin-left: 291px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">6. recordingStateChanged (started)</div></div></div></foreignObject><text x="291" y="967" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">6. recordingStateChanged (started)</text></switch></g></g></g><g data-cell-id="state-rec-active"><g><rect x="56" y="980" width="70" height="20" rx="3" ry="3" fill="#dae8fc" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 990px; margin-left: 57px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">[RECORDING]</div></div></div></foreignObject><text x="91" y="993" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle" font-weight="bold">[RECORDING]</text></switch></g></g></g><g data-cell-id="media-capture"><g><path d="M 891 1010 L 99.24 1010" fill="none" stroke="#9673a6" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 93.24 1010 L 101.24 1006 L 99.24 1010 L 101.24 1014 Z" fill="#9673a6" stroke="#9673a6" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1010px; margin-left: 491px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">Audio/Video RTP streams (receive-only)</div></div></div></foreignObject><text x="491" y="1013" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Audio/Video RTP streams (receive-only)</text></switch></g></g></g><g data-cell-id="inj-msg7"><g><path d="M 91 1045 L 280.76 1045" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 288.76 1045 L 280.76 1049 L 280.76 1041 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1042px; margin-left: 191px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">7. DELETE /communications/calls/{id} or callEnded</div></div></div></foreignObject><text x="191" y="1042" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle">7. DELETE /communications/calls/{id} or callEnded</text></switch></g></g></g><g data-cell-id="state-rec-stopped"><g><rect x="61" y="1055" width="60" height="20" rx="3" ry="3" fill="#f8cecc" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 1065px; margin-left: 62px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">[STOPPED]</div></div></div></foreignObject><text x="91" y="1068" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px" text-anchor="middle" font-weight="bold">[STOPPED]</text></switch></g></g></g><g data-cell-id="ep-title"><g><rect x="1051" y="60" width="300" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 298px; height: 1px; padding-top: 75px; margin-left: 1053px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">Recording Service Endpoints</div></div></div></foreignObject><text x="1053" y="80" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="16px" font-weight="bold">Recording Service Endpoints</text></switch></g></g></g><g data-cell-id="graph-calls"><g><rect x="1051" y="100" width="260" height="260" rx="39" ry="39" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 246px; height: 1px; padding-top: 113px; margin-left: 1058px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Graph Communications API</b><hr /><div style="text-align:left;font-family:monospace;font-size:10px"><b>Join Call:</b><br />POST /communications/calls<br /><br /><b>Get Call:</b><br />GET /communications/calls/{id}<br /><br /><b>Leave Call:</b><br />DELETE /communications/calls/{id}<br /><br /><b>Update Recording:</b><br />POST /calls/{id}/updateRecordingStatus<br /><br /><b>Subscribe to Media:</b><br />POST /calls/{id}/subscribeToTone</div></div></div></div></foreignObject><text x="1181" y="125" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Graph Communications API...</text></switch></g></g></g><g data-cell-id="join-body"><g><rect x="1331" y="100" width="200" height="380" rx="30" ry="30" fill="#f5f5f5" stroke="#666666" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 192px; height: 1px; padding-top: 110px; margin-left: 1335px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Join Call Payload</b><hr /><div style="text-align:left;font-family:monospace;font-size:9px">{<br />  "@odata.type": "#microsoft<br />    .graph.call",<br />  "callbackUri": "https://...",<br />  "requestedModalities": [<br />    "audio", "video"<br />  ],<br />  "mediaConfig": {<br />    "@odata.type": "#microsoft<br />      .graph.appHostedMediaConfig",<br />    "blob": "{sdp-blob}"<br />  },<br />  "chatInfo": {<br />    "threadId": "19:meeting...",<br />    "messageId": "0"<br />  },<br />  "meetingInfo": {<br />    "@odata.type": "#microsoft<br />      .graph.organizerMeetingInfo",<br />    "organizer": {<br />      "identity": { ... }<br />    }<br />  }<br />}</div></div></div></div></foreignObject><text x="1431" y="122" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Join Call Payload...</text></switch></g></g></g><g data-cell-id="status-updates"><g><rect x="1051" y="380" width="200" height="150" rx="22.5" ry="22.5" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 192px; height: 1px; padding-top: 390px; margin-left: 1055px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Recording Status Values</b><hr /><div style="text-align:left;font-size:11px"><b>notRecording</b><br />No active recording<br /><br /><b>recording</b><br />Active recording in progress<br /><br /><b>failed</b><br />Recording failed to start</div></div></div></div></foreignObject><text x="1151" y="402" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Recording Status Values...</text></switch></g></g></g><g data-cell-id="callbacks"><g><rect x="1051" y="550" width="200" height="180" rx="27" ry="27" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 192px; height: 1px; padding-top: 560px; margin-left: 1055px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Callback Notifications</b><hr /><div style="text-align:left;font-size:11px"><b>callStateChanged</b><br />Bot joined/left call<br /><br /><b>participantsUpdated</b><br />Roster changes<br /><br /><b>recordingStateChanged</b><br />Recording status update<br /><br /><b>mediaStateChanged</b><br />Media channel state</div></div></div></div></foreignObject><text x="1151" y="572" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Callback Notifications...</text></switch></g></g></g><g data-cell-id="media-config"><g><rect x="1331" y="500" width="200" height="110" rx="16.5" ry="16.5" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 192px; height: 1px; padding-top: 510px; margin-left: 1335px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b>Media Configuration</b><hr /><div style="text-align:left;font-size:10px">- appHostedMediaConfig: Bot hosts media<br />- serviceHostedMediaConfig: Teams hosts<br />- Recording bots use app-hosted<br />- Requires media platform SDK</div></div></div></div></foreignObject><text x="1431" y="522" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Media Configuration...</text></switch></g></g></g><g data-cell-id="relation-title"><g><rect x="1151" y="660" width="250" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 675px; margin-left: 1153px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">Relationship to Call Signaling</div></div></div></foreignObject><text x="1153" y="680" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="16px" font-weight="bold">Relationship to Call Signaling</text></switch></g></g></g><g data-cell-id="relation-box"><g><rect x="1151" y="700" width="380" height="180" rx="27" ry="27" fill="#e1d5e7" stroke="#9673a6" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 362px; height: 1px; padding-top: 715px; margin-left: 1161px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="text-align:left;font-size:11px">The recorder bot participates in the same call signaling<br />infrastructure as regular clients:<br /><br />1. <b>Joins via Graph API</b> (not Trouter invitation)<br />2. <b>Receives SDP offer/answer</b> like any participant<br />3. <b>Gets roster updates</b> via callback notifications<br />4. <b>Media flows through SRTP</b> to bot endpoint<br />5. <b>Leaves call</b> via DELETE or when call ends<br /><br />Key difference: Bot uses <b>receiveOnly</b> media direction<br />to capture without transmitting.</div></div></div></div></foreignObject><text x="1161" y="727" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="12px">The recorder bot participates in the same call signaling...</text></switch></g></g></g><g data-cell-id="legend-title"><g><rect x="751" y="390" width="100" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 98px; height: 1px; padding-top: 405px; margin-left: 753px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">Legend</div></div></div></foreignObject><text x="753" y="409" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="14px" font-weight="bold">Legend</text></switch></g></g></g><g data-cell-id="legend-box"><g><rect x="751" y="430" width="200" height="150" rx="22.5" ry="22.5" fill="#f5f5f5" stroke="#666666" pointer-events="all"/></g></g><g data-cell-id="legend-http"><g><path d="M 766 455 L 805.76 455" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 813.76 455 L 805.76 459 L 805.76 451 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="legend-http-text"><g><rect x="826" y="445" width="100" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 455px; margin-left: 828px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">HTTP Request</div></div></div></foreignObject><text x="828" y="458" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px">HTTP Request</text></switch></g></g></g><g data-cell-id="legend-ws"><g><path d="M 766 485 L 805.76 485" fill="none" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 813.76 485 L 805.76 489 L 805.76 481 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="legend-ws-text"><g><rect x="826" y="475" width="120" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 485px; margin-left: 828px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">Callback / Notification</div></div></div></foreignObject><text x="828" y="488" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px">Callback / Notification</text></switch></g></g></g><g data-cell-id="legend-media"><g><path d="M 766 515 L 807.76 515" fill="none" stroke="#9673a6" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="6 6" pointer-events="stroke"/><path d="M 813.76 515 L 805.76 519 L 807.76 515 L 805.76 511 Z" fill="#9673a6" stroke="#9673a6" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/></g></g><g data-cell-id="legend-media-text"><g><rect x="826" y="505" width="100" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 515px; margin-left: 828px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">Media Stream</div></div></div></foreignObject><text x="828" y="518" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px">Media Stream</text></switch></g></g></g><g data-cell-id="legend-state"><g><ellipse cx="791" cy="550" rx="25" ry="15" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all"/></g></g><g data-cell-id="legend-state-text"><g><rect x="826" y="540" width="50" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 550px; margin-left: 828px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">State</div></div></div></foreignObject><text x="828" y="553" fill="rgb(0, 0, 0)" font-family="&quot;Helvetica&quot;" font-size="10px">State</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>